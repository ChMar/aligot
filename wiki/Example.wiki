#summary Example of analysis

These examples assumed you downloaded the vanilla directory from svn trunk.

= TEA =

== Tracing ==

  * Let's analyze the program: vanilla/testBinaries/TEA_Od.exe. You should rapidly found the following function that seems to do some crypto weird stuff! 

<img src="http://aligot.googlecode.com/svn/img/TEA_Od_IDA.png" height="500" >

Let's find if it is a known algorithm :)
  * Get the pintool: vanilla/pin2.12/aligotTracer.dll
  * Collect the execution trace:
{{{
>pin -t aligotTracer.dll startA 401020 endA 40109F -- TEA_Od.exe
df5ec153
6e089494
}}}

We specified the start and end addresses of the previous function with the arguments startA and endA. You could also collect a full trace of the program but the rest of the analysis is going to take a lot more time. Currently the tool is only suitable for such focus analysis.

  * You should then obtain the file trace.out that looks like this:
{{{
!SOT
401020!push ebp!RR_ebp_12ff7c_esp_12ff5c!WM_12ff58_4_12ff7c!WR_esp_12ff58
401021!mov ebp, esp!RR_esp_12ff58!WR_ebp_12ff58
401023!sub esp, 0x14!RR_esp_12ff58!WR_esp_12ff44
...
}}}
== Extraction of possible crypto algorithms based on loops ==

  * Go into vanilla/extraction and launch:
{{{
> python main.py trace.out
Aligot extraction module
Magic started at
2012-09-27 12:31:46.261000
Loop detection... Done
Garbage collector for invalid loops... Done (47 loops suppressed)
Loop I/O... Done
Garbage collector for useless loops (no I/O)... Done (0 loops suppressed)
Loop data flow graph building... Done
Garbage collector for invalid LDFs... Done
Loop data flow I/O building... Done
Garbage collector for useless LDFs... Done
Assigning values to I/O memory parameters... Done
-----------------------------------
Loop Data Flow 0
1 loop instances
Start time : 20  (start address: 401055)
End time : 755
Input Parameters:
0x12ff50:4  de ad be e4  |  0x12ff4c:4  de ad be e3  |  0x12ff48:4  de ad be e2  |  0x12ff44:4  de ad be e1  |  0x12ff54:4  00 0
0 00 20  |  eax:4  89 ab cd ef  |  ebp:4  00 12 ff 58  |  edx:4  c6 ef 37 20  |  ecx:4  01 23 45 67  |  0x0:4  61 c8 86 47  |
Output Parameters:
0x12ff54:4  00 00 00 00  |  edi:4  0c 40 0e 4d  |  eax:4  6e 08 94 94  |  edx:4  00 00 00 00  |  esi:4  51 69 05 ea  |  ecx:4  d
f 5e c1 53  |
-----------------------------------
Dumping results... Done
Magic ended at
2012-09-27 12:31:46.353000
Producing graph... Done
}}}

debug graph, virer display du loop storage...